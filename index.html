<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday â€” Priyanshi ðŸŽ€</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg: #fff6fb;
    --card: #fff;
    --accent: #f06292; /* pinkish */
    --accent-soft: #ff9dbf;
    --muted: #6b6b6b;
    --glass: rgba(255,255,255,0.18);
  }
  html,body{height:100%;margin:0;font-family:"Poppins",sans-serif;background:linear-gradient(180deg,var(--bg), #fff0f6);color:#222;}
  .centered { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:24px; box-sizing:border-box; }

  /* Intro */
  .intro-card{ max-width:920px; width:100%; text-align:center; padding:28px; border-radius:20px; background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.92)); box-shadow:0 20px 50px rgba(240,120,160,0.12); border:1px solid rgba(255,200,220,0.6); }
  .intro-title{ font-size:36px; color:var(--accent); margin:6px 0; font-weight:700; letter-spacing:0.2px; }
  .intro-sub{ font-size:16px; color:var(--muted); margin-bottom:18px; }
  .surprise-btn{ background: linear-gradient(90deg,var(--accent), #c84a84); color:white; padding:12px 22px; border-radius:14px; border:none; cursor:pointer; font-weight:700; box-shadow:0 12px 30px rgba(200,80,140,0.12); font-size:16px; transition:transform .16s ease, box-shadow .16s ease; }
  .surprise-btn:active{ transform:translateY(2px); }
  .tiny-note{ margin-top:12px; color:var(--muted); font-size:13px; }

  /* Gallery page area */
  .page { display:none; padding:28px; box-sizing:border-box; max-width:980px; margin:0 auto; }
  .page.active { display:block; }

  .page-header { text-align:center; margin-bottom:12px; }
  .page-header h2{ font-size:28px; color:var(--accent); margin:0; }
  .page-header p{ color:var(--muted); margin:8px 0 0 0; font-size:14px; }

  /* gallery slider - centered and small frames */
  .gallery-wrap{ display:flex; flex-direction:column; align-items:center; gap:14px; margin-top:12px; }
  .slider{ width:100%; max-width:820px; overflow:hidden; border-radius:16px; background:var(--card); padding:12px; box-shadow:0 18px 48px rgba(200,120,170,0.06); border:1px solid rgba(255,220,235,0.6); }
  .slides{ display:flex; gap:14px; transition:transform 700ms ease; will-change:transform; }
  .slide{ flex:0 0 auto; width:150px; border-radius:12px; overflow:hidden; position:relative; background:var(--card); cursor:pointer; }
  .slide img{ width:100%; height:200px; object-fit:cover; display:block; transition:transform .3s ease, filter .3s ease; }
  .slide:hover img{ transform:scale(1.04); filter:brightness(.95); }
  .slide .caption{ font-size:13px; color:var(--muted); text-align:center; padding:8px 6px; }

  /* slider controls */
  .controls{ display:flex; gap:10px; align-items:center; margin-top:10px; }
  .control-btn{ background:transparent; border:1px solid rgba(200,120,160,0.12); padding:8px 12px; border-radius:10px; cursor:pointer; color:var(--accent); font-weight:600; }
  .control-btn:active{ transform:translateY(1px); }
  .spacer{ width:12px; }

  /* glass popup (tilted quote style) */
  .popup-back{ position:fixed; inset:0; background: rgba(0,0,0,0.36); backdrop-filter: blur(6px); display:none; align-items:center; justify-content:center; z-index:80; padding:20px; }
  .glass-card{ width:100%; max-width:480px; background: linear-gradient(135deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06)); border-radius:14px; padding:18px; color:white; transform:rotate(-4deg); border:1px solid rgba(255,255,255,0.2); box-shadow:0 18px 40px rgba(0,0,0,0.18); }
  .glass-quote{ font-size:16px; line-height:1.5; color:#fff; }
  .glass-close{ margin-top:12px; display:inline-block; padding:8px 12px; background:rgba(255,255,255,0.12); color:white; border-radius:10px; border:none; cursor:pointer; font-weight:700; }

  /* cake page */
  .cake-area{ display:flex; flex-direction:column; align-items:center; gap:12px; padding-top:20px; }
  .cake-wrap{ width:260px; height:160px; border-radius:16px; background: linear-gradient(180deg,#ffd8e8,#ffcde0); display:flex; align-items:center; justify-content:center; position:relative; box-shadow:0 20px 50px rgba(230,120,160,0.12); }
  .cake-body{ width:180px; height:120px; background: linear-gradient(180deg,#ffb7d5,#ffa3c7); border-radius:12px; position:relative; box-shadow:0 8px 30px rgba(0,0,0,0.06); }
  .icing{ position:absolute; top:-16px; width:220px; height:36px; background:#fff6fb; border-radius:50px; left:50%; transform:translateX(-50%); box-shadow:0 6px 20px rgba(255,200,230,0.6); }
  .candle{ position:absolute; top:-46px; left:50%; transform:translateX(-50%); width:16px; height:40px; background: linear-gradient(180deg,#fff,#ffe9f1); border-radius:5px; display:flex; align-items:flex-start; justify-content:center; cursor:pointer; box-shadow:0 6px 18px rgba(255,140,180,0.2); }
  .flame{ width:14px; height:20px; border-radius:50%; background: radial-gradient(circle at 45% 30%, #fff6a9, #ffc85c 45%, #ff8844 80%); position:absolute; top:-26px; left:50%; transform:translateX(-50%); box-shadow:0 6px 20px rgba(255,150,100,0.25); animation:flame 900ms infinite; }
  @keyframes flame{ 0%{ transform: translateX(-50%) scale(1); } 50% { transform: translateX(-50%) scale(1.08);} 100%{ transform: translateX(-50%) scale(1);} }

  /* letter panel with cut button (transparent background) */
  .letter-panel{ margin-top:18px; width:90%; max-width:680px; background:rgba(255,255,255,0.95); border-radius:12px; padding:18px; box-shadow:0 12px 30px rgba(0,0,0,0.06); position:relative; text-align:left; }
  .letter-text{ font-size:16px; color:#333; white-space:pre-wrap; min-height:80px; }
  .cut-btn{ position:absolute; top:10px; right:10px; background: rgba(255,255,255,0.06); border:1px solid rgba(220,120,160,0.12); color:var(--accent); padding:8px 10px; border-radius:10px; cursor:pointer; font-weight:700; backdrop-filter: blur(4px); }
  .signature{ margin-top:12px; font-weight:600; color:var(--accent); font-size:15px; min-height:22px; }

  /* floating play button (for autoplay) */
  #playFloating{ position:fixed; bottom:18px; right:18px; z-index:90; background: linear-gradient(90deg,var(--accent), #c84a84); color:white; border:none; padding:10px 14px; border-radius:12px; box-shadow:0 12px 30px rgba(200,80,140,0.12); cursor:pointer; font-weight:700; }

  /* small responsiveness */
  @media (max-width:720px){
    .slides{ gap:12px; }
    .slide{ width:140px; }
    .gallery{ gap:10px; }
    .intro-title{ font-size:28px; }
    .cake-wrap{ width:220px; height:140px; }
  }
</style>
</head>
<body>

<!-- AUDIO (user-provided mp3) -->
<audio id="bgMusic" loop preload="auto">
  <source src="https://o.uguu.se/ewiwJDBv.mp3" type="audio/mp3">
</audio>

<!-- INTRO / Landing -->
<div id="intro" class="centered">
  <div class="intro-card" role="main" aria-labelledby="introTitle">
    <div id="introTitle" class="intro-title">Happy Birthday Priyanshi ji âœ¨</div>
    <div class="intro-sub">A small page I made for your special day â€” just vibes, smiles and good energy ðŸ’«</div>
    <button id="startSurprise" class="surprise-btn" aria-controls="galleryPage">Open Surprise</button>
    <div class="tiny-note">Tap the button to open your surprise â€” music will start when you open it ðŸŽµ</div>
  </div>
</div>

<!-- GALLERY PAGE -->
<section id="galleryPage" class="page" aria-hidden="true">
  <div class="page-header">
    <h2>Memory Core</h2>
    <p>Little moments collected â€” tap a photo to read a short note.</p>
  </div>

  <div class="gallery-wrap">
    <div class="slider" aria-live="polite">
      <div class="slides" id="slidesRow">
        <!-- slides: use the 6 images user gave (kept small) -->
        <div class="slide" data-index="0"><img src="https://i.ibb.co/qwYzdhW/IMG-20251116-120503.jpg" alt="photo1"><div class="caption">Tap to view âœ¦</div></div>
        <div class="slide" data-index="1"><img src="https://i.ibb.co/93Nz1cQQ/IMG-20251116-120448.jpg" alt="photo2"><div class="caption">Tap to view âœ¦</div></div>
        <div class="slide" data-index="2"><img src="https://i.ibb.co/wh3YTbMT/IMG-20251116-121550-318.jpg" alt="photo3"><div class="caption">Tap to view âœ¦</div></div>
        <div class="slide" data-index="3"><img src="https://i.ibb.co/cpvn3PS/IMG-20251116-121553-635.jpg" alt="photo4"><div class="caption">Tap to view âœ¦</div></div>
        <div class="slide" data-index="4"><img src="https://i.ibb.co/twgDQMR9/IMG-20251116-121555-261.jpg" alt="photo5"><div class="caption">Tap to view âœ¦</div></div>
        <div class="slide" data-index="5"><img src="https://i.ibb.co/6c04yzFr/IMG-20251116-121556-285.jpg" alt="photo6"><div class="caption">Tap to view âœ¦</div></div>
      </div>
    </div>

    <div class="controls" aria-hidden="false">
      <button id="prevBtn" class="control-btn" aria-label="Previous">Previous</button>
      <div class="spacer"></div>
      <button id="nextSurprise" class="control-btn" aria-label="Next Surprise">Next Surprise</button>
    </div>
  </div>
</section>

<!-- GLASS POPUP -->
<div class="popup-back" id="glassPopup" aria-hidden="true">
  <div class="glass-card" role="dialog" aria-modal="true" aria-labelledby="popupMessage">
    <div class="glass-quote" id="popupMessage">Message</div>
    <button class="glass-close" id="glassClose">Close</button>
  </div>
</div>

<!-- CAKE PAGE -->
<section id="cakePage" class="page" aria-hidden="true">
  <div class="page-header">
    <h2>Cake Surprise</h2>
    <p>Make a wish â€” click the candle âœ¨</p>
  </div>

  <div class="cake-area">
    <div class="cake-wrap" aria-hidden="true">
      <div class="icing" aria-hidden="true"></div>
      <div class="cake-body" aria-hidden="true"></div>

      <div class="candle" id="candleBtn" role="button" aria-label="Blow candle">
        <div class="flame" id="candleFlame" aria-hidden="true"></div>
      </div>
    </div>

    <div class="letter-panel" id="letterPanel" style="display:none;">
      <button class="cut-btn" id="cutBtn" title="Cut the letter (finish typing)" aria-pressed="false">Cut âœ‚</button>
      <div class="letter-text" id="letterText" aria-live="polite"></div>
      <div class="signature" id="signatureArea"></div>
    </div>
  </div>
</section>

<!-- floating play (if user wants to play/pause manually) -->
<button id="playFloating" aria-label="Play background music" title="Play music">Play Music</button>

<script>
/* -------------------------
   Page flow & DOM elements
   ------------------------- */
const intro = document.getElementById('intro');
const startBtn = document.getElementById('startSurprise');
const galleryPage = document.getElementById('galleryPage');
const cakePage = document.getElementById('cakePage');
const bgMusic = document.getElementById('bgMusic');
const playFloating = document.getElementById('playFloating');

const slidesRow = document.getElementById('slidesRow');
const slides = Array.from(document.querySelectorAll('.slide'));
const glassPopup = document.getElementById('glassPopup');
const popupMessage = document.getElementById('popupMessage');
const glassClose = document.getElementById('glassClose');

const prevBtn = document.getElementById('prevBtn');
const nextSurprise = document.getElementById('nextSurprise');

const candleBtn = document.getElementById('candleBtn');
const candleFlame = document.getElementById('candleFlame');
const letterPanel = document.getElementById('letterPanel');
const letterText = document.getElementById('letterText');
const cutBtn = document.getElementById('cutBtn');
const signatureArea = document.getElementById('signatureArea');

let slideIndex = 0;
let slideWidth = 0;
let autoSlideTimer = null;
let autoSlideDelay = 3000; // 3s between slides (slow)
let isSliding = true;
let popupOpen = false;

/* -------------------------
   Messages for each image
   (non-romantic, cute)
   ------------------------- */
const messages = [
  'You carry a calm energy â€” quietly bright and lovely.',
  'That smile is soft and honest â€” makes small moments better.',
  'A photo that feels like a gentle, happy memory.',
  'Simple and naturally photogenic â€” love this vibe.',
  'A candid frame that belongs in a happy collection.',
  'Bright, wholesome and easy-going energy â€” very pretty.'
];

/* -------------------------
   Utilities: position slides
   ------------------------- */
function updateSlideDimensions(){
  // calculate slide width dynamically
  const slideElem = slides[0];
  slideWidth = slideElem ? slideElem.getBoundingClientRect().width + 14 : 164; // include gap
}
function goToSlide(i){
  slideIndex = (i + slides.length) % slides.length;
  const x = -(slideIndex * (slideWidth));
  slidesRow.style.transform = `translateX(${x}px)`;
}

/* -------------------------
   Auto slide control
   ------------------------- */
function startAutoSlide(){
  stopAutoSlide();
  autoSlideTimer = setInterval(()=> {
    if(!isSliding || popupOpen) return;
    goToSlide(slideIndex + 1);
  }, autoSlideDelay);
}
function stopAutoSlide(){
  if(autoSlideTimer) { clearInterval(autoSlideTimer); autoSlideTimer = null; }
}

/* -------------------------
   Popup logic (glass popup)
   ------------------------- */
function openPopupFor(index){
  popupMessage.textContent = messages[index] || '';
  glassPopup.style.display = 'flex';
  glassPopup.setAttribute('aria-hidden','false');
  popupOpen = true;
  stopAutoSlide();
}
function closePopup(){
  glassPopup.style.display = 'none';
  glassPopup.setAttribute('aria-hidden','true');
  popupOpen = false;
  // resume after a tiny delay to allow user to see effect
  setTimeout(()=> { if(!autoSlideTimer) startAutoSlide(); }, 220);
}

/* attach click on slides */
slides.forEach((s, idx) => {
  s.addEventListener('click',(e)=>{
    openPopupFor(idx);
  });
});

/* close popup on background click or close button */
glassClose.addEventListener('click', closePopup);
glassPopup.addEventListener('click', (e)=>{ if(e.target === glassPopup) closePopup(); });

/* -------------------------
   Prev / Next Surprise controls
   ------------------------- */
prevBtn.addEventListener('click', ()=> {
  isSliding = false; // stop temporarily
  goToSlide(slideIndex - 1);
  // small resume timer
  setTimeout(()=> { isSliding = true; }, 1000);
});

nextSurprise.addEventListener('click', ()=> {
  // open cake page (keep music playing)
  showCakePage();
});

/* -------------------------
   Start Surprise: show gallery, play music
   ------------------------- */
startBtn.addEventListener('click', async ()=>{
  // hide intro, show gallery
  intro.style.display = 'none';
  galleryPage.classList.add('active');
  galleryPage.setAttribute('aria-hidden','false');

  // start music - must be triggered by user gesture so allowed
  try{
    await bgMusic.play();
    playFloating.style.display = 'none';
  }catch(e){
    // play blocked or error
    console.warn('bgMusic play blocked', e);
    playFloating.style.display = 'block';
  }

  // prepare slider
  updateSlideDimensions();
  goToSlide(0);
  isSliding = true;
  startAutoSlide();

  // ensure resize updates dims
  window.addEventListener('resize', ()=> { updateSlideDimensions(); goToSlide(slideIndex); });
});

/* floating manual play/pause */
playFloating.addEventListener('click', async ()=>{
  try{
    if(bgMusic.paused){
      await bgMusic.play();
      playFloating.textContent = 'Pause Music';
    } else {
      bgMusic.pause();
      playFloating.textContent = 'Play Music';
    }
  }catch(e){ console.warn(e); }
});

/* -------------------------
   Cake page flow & typing
   ------------------------- */
function showCakePage(){
  galleryPage.classList.remove('active');
  galleryPage.setAttribute('aria-hidden','true');
  cakePage.classList.add('active');
  cakePage.setAttribute('aria-hidden','false');
  // stop slider
  stopAutoSlide();
  isSliding = false;
  // ensure letter panel reset
  letterPanel.style.display = 'none';
  letterText.textContent = '';
  signatureArea.textContent = '';
  cutBtn.setAttribute('aria-pressed','false');
}

/* Candle click -> extinguish flame, then type letter */
let typingTimer = null;
let typingIndex = 0;
let letterFull = `Dear Priyanshi,

Wishing you a day filled with soft smiles, quiet joy, and tiny moments that make your heart light.
May this year bring you calm, creativity, and little surprises that make you smile.

Happy Birthday! âœ¨`;

let signature = '--- (from Shivansh)';

candleBtn.addEventListener('click', (e)=>{
  // hide flame
  candleFlame.style.display = 'none';
  // reveal letter panel
  letterPanel.style.display = 'block';
  // start typing main letter
  typingIndex = 0;
  letterText.textContent = '';
  signatureArea.textContent = '';
  cutBtn.setAttribute('aria-pressed','false');
  startTypingLetter();
});

function startTypingLetter(){
  // clear old timer if any
  if(typingTimer) clearInterval(typingTimer);
  typingTimer = setInterval(()=> {
    if(typingIndex < letterFull.length){
      letterText.textContent += letterFull.charAt(typingIndex);
      typingIndex++;
    } else {
      clearInterval(typingTimer);
      typingTimer = null;
      // when finished, start signature typing after small delay
      setTimeout(()=> startSignatureTyping(), 700);
    }
  }, 28); // speed
}

/* signature typing */
let sigIdx = 0;
let sigTimer = null;
function startSignatureTyping(){
  sigIdx = 0;
  signatureArea.textContent = '';
  if(sigTimer) clearInterval(sigTimer);
  sigTimer = setInterval(()=> {
    if(sigIdx < signature.length){
      signatureArea.textContent += signature.charAt(sigIdx);
      sigIdx++;
    } else {
      clearInterval(sigTimer);
      sigTimer = null;
    }
  }, 34);
}

/* Cut button: skip to signature (finish / stop typing) */
cutBtn.addEventListener('click', ()=>{
  // mark pressed
  cutBtn.setAttribute('aria-pressed','true');
  // stop typing main letter
  if(typingTimer){ clearInterval(typingTimer); typingTimer = null; }
  // reveal full letter immediately
  letterText.textContent = letterFull;
  // start signature typing if not started
  if(sigTimer){ clearInterval(sigTimer); sigTimer = null; }
  startSignatureTyping();
});

/* allow closing cake page and go back to gallery (optional) - we keep music playing */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape'){
    // close popup if open
    if(glassPopup.style.display === 'flex') closePopup();
  }
});

/* Accessibility - ensure click outside glass closes popup is handled above */
</script>
</body>
  </html>

